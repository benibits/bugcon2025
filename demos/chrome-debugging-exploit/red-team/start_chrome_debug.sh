#!/bin/bash
# Start Chrome with Remote Debugging Enabled
# For BugCon 2025 Demo
# Compatible with Linux and macOS

echo "Starting Chrome with debugging enabled on port 9222..."
echo

# Create temp directory if it doesn't exist
TEMP_DIR="$HOME/.chrome-debug"
if [ ! -d "$TEMP_DIR" ]; then
    mkdir -p "$TEMP_DIR"
fi

# Function to start Chrome with debugging
start_chrome() {
    "$1" --remote-debugging-port=9222 --user-data-dir="$TEMP_DIR" --remote-allow-origins=* &
    CHROME_PID=$!
    echo
    echo "Chrome is now running with debugging enabled! (PID: $CHROME_PID)"
    echo "You can verify by visiting: http://localhost:9222/json"
    echo
}

# Try to find and start Chrome
# Check macOS paths first
if [ -f "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome" ]; then
    echo "Found Chrome on macOS..."
    start_chrome "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome"
# Check Linux paths
elif command -v google-chrome &> /dev/null; then
    echo "Found google-chrome..."
    start_chrome "google-chrome"
elif command -v google-chrome-stable &> /dev/null; then
    echo "Found google-chrome-stable..."
    start_chrome "google-chrome-stable"
elif command -v chromium-browser &> /dev/null; then
    echo "Found chromium-browser..."
    start_chrome "chromium-browser"
elif command -v chromium &> /dev/null; then
    echo "Found chromium..."
    start_chrome "chromium"
else
    echo "ERROR: Chrome/Chromium not found!"
    echo "Please install Chrome or Chromium, or update the paths in this script."
    exit 1
fi

echo "Script completed. Chrome is running in the background."
echo "To stop Chrome, use: kill $CHROME_PID"

